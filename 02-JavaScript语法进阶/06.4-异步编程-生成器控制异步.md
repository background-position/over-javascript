# 06.4-异步编程-生成器控制异步

### 3.1 生成器函数在异步中的应用

三个异步函数的实例：

```js
function fn1() {
  setTimeout(() => {
    console.log(1111)
  }, 1000)
}

function fn2() {
  setTimeout(() => {
    console.log(2222)
  }, 1100)
}

function fn3() {
  setTimeout(() => {
    console.log(3333)
  }, 1200)
}
```

如果要让其按照 fn1、fn2、fn3 的顺序执行，那么按照回调函数的做法应该是：

```js
setTimeout(){
  setTimeout(){
    setTimeout(){

    }
  }
}
```

这显然形成了回调地狱，现在利用生成器函数可以写为：

```js
function fn1() {
  setTimeout(() => {
    console.log(1111)
    iterator.next()
  }, 1000)
}

function fn2() {
  setTimeout(() => {
    console.log(2222)
    iterator.next()
  }, 1100)
}

function fn3() {
  setTimeout(() => {
    console.log(3333)
    iterator.next()
  }, 1200)
}

// 如果我们想让 fn1、fn2、fn3 按顺序执行
function* gen() {
  yield fn1()
  yield fn2()
  yield fn3()
}

let iterator = gen()
iterator.next()
```
